<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>cf-labroom Login Demo</title>
  <style>
    body {
      margin: 0;
      min-height: 100vh;
      background: linear-gradient(180deg, #0f172a, #020617);
      color: #f8fafc;
      display: flex;
      justify-content: center;
      align-items: center;
      font-family: "Noto Sans", "Segoe UI", sans-serif;
    }
    main {
      width: min(420px, 100%);
      background: rgba(15, 23, 42, 0.9);
      border-radius: 20px;
      padding: 2.5rem;
      box-shadow: 0 20px 40px rgba(2, 6, 23, 0.9);
      border: 1px solid rgba(79, 70, 229, 0.3);
    }
    h1 {
      margin-top: 0;
      font-size: clamp(1.75rem, 3vw, 2.4rem);
    }
    label {
      display: block;
      margin-bottom: 0.35rem;
      font-weight: 600;
    }
    input {
      width: 100%;
      padding: 0.65rem 0.75rem;
      margin-bottom: 1rem;
      border-radius: 10px;
      border: 1px solid rgba(148, 163, 184, 0.3);
      background: rgba(15, 23, 42, 0.6);
      color: #e2e8f0;
    }
    button {
      width: 100%;
      padding: 0.75rem;
      border-radius: 10px;
      border: none;
      background: linear-gradient(90deg, #38bdf8, #6366f1);
      color: white;
      font-weight: 600;
      cursor: pointer;
      font-size: 1rem;
    }
    button:disabled {
      opacity: 0.6;
      cursor: wait;
    }
    .status {
      margin-top: 1rem;
      padding: 0.75rem 1rem;
      border-radius: 10px;
      background: rgba(15, 23, 42, 0.6);
      border: 1px solid rgba(148, 163, 184, 0.4);
    }
    .status.success {
      border-color: rgba(34, 197, 94, 0.6);
      color: #34d399;
    }
    .status.error {
      border-color: rgba(248, 113, 113, 0.6);
      color: #f87171;
    }
    small {
      color: #94a3b8;
    }
  </style>
</head>
<body>
  <main>
    <h1>登入測試</h1>
    <p>輸入 user 並使用當前 <strong>UTC</strong> 的 <code>hh:mm</code> 作為密碼（每分鐘變化）</p>
    <form id="login">
      <label for="user">使用者</label>
      <input id="user" name="user" value="admin" required />

      <label for="pwd">密碼（UTC hh:mm）</label>
      <input id="pwd" name="pwd" placeholder="例: 03:45" pattern="\\d{2}:\\d{2}" required />

      <button type="submit">送出</button>
    </form>
    <div id="status" class="status" hidden></div>
  </main>

  <script>
    const form = document.getElementById("login");
    const statusEl = document.getElementById("status");

    form.addEventListener("submit", async (event) => {
      event.preventDefault();
      statusEl.hidden = true;
      statusEl.textContent = "";
      statusEl.className = "status";
      const button = form.querySelector("button");
      button.disabled = true;

      const payload = {
        user: form.user.value,
        pwd: form.pwd.value,
      };

      try {
        const response = await fetch("/api/login", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
          },
          body: JSON.stringify(payload),
        });
        const data = await response.json();
        statusEl.hidden = false;
        statusEl.textContent = JSON.stringify(data, null, 2);
        statusEl.classList.add(response.ok ? "success" : "error");
      } catch (error) {
        statusEl.hidden = false;
        statusEl.textContent = "請求失敗：" + error.message;
        statusEl.classList.add("error");
      } finally {
        button.disabled = false;
      }
    });
  </script>
</body>
</html>
